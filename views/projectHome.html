<!doctype html>

<html lang="en">
<head>
  <meta charset="utf-8">

  <title>Saga</title>
  <meta name="description" content="Saga - Version Control for All Your Files">
  <meta name="author" content="Saga">
  <link rel='icon' href='/graphics/saga-website-logo.png' type='image/x-icon' />

  <link rel="stylesheet" href="css/userPages/projectHome.css">
  <link rel="stylesheet" href="css/userPages/header.css">
  <link rel="stylesheet" href="css/font.css">
  <link rel="stylesheet" href="css/colors.css">
</head>

<script>

  // TODO Figure out a better way to do this
  var projectName = "<%= projectName %>";
  openProject(projectName)


  function openProject(path) {
    $.ajax({
      type: "POST",
      url: "/projectpath",
      data: {path: path},
      success: function (data) {
        console.log(data)
         // Clear Project Directory
        var projectDirectory = document.getElementById('project-directory')
        while (projectDirectory.firstChild) {
          projectDirectory.removeChild(projectDirectory.firstChild);
        }

        // Display new paths
        if (data.paths) {
          for (var i = 0; i < data.paths.length; i++) {
            listPathContent(data.paths[i])
          }
        } else {
          console.log(res)
        }
      }
    });
    console.log("error??")
  }

  function listPathContent(path) {
    console.log("LIST PATH CONTENTS: " + path)
    splitPath = path.split('/')
    name = splitPath[splitPath.length - 1]

    var row = document.createElement('div')

    var graphic = document.createElement('img')
    graphic.className = "graphics"
    graphic.src = "/graphics/userPages/folder.png"
    graphic.width = "20"
    graphic.height = "20"

    var contentButton = document.createElement('button');
    contentButton.className = "file-or-folder standard-font dark-font"
    contentButton.innerHTML = name

    contentButton.onclick = function () {
      console.log("clicked content button: " + path)
      openProject(path)
    }

    row.appendChild(graphic)
    row.appendChild(contentButton)

    document.getElementById('project-directory').appendChild(row)

  }

  function displayTextFile(file) {
    var textFile = document.createElement('object')
    textFile.setAttribute("width") = 300
    textFile.setAttribute("height") = 300
    textFile.setAttribute("type") = "text/plain"
    textFile.data = file

    document.getElementById('project-directory').appendChild(textFile)

  }
</script>

<body class = "wrapper">
  <header class = "header">
    <div class="header standard-font dark-font">
        <a href="/" class="left-header">
            <img src="/graphics/saga-website-logo.png" width="100"></img>
            <p class = logo-text>saga</p>
        </a>
        <div class="right-header">
            <form> 
              <input class = "searchbar standard-font dark-font" placeholder="search"> </input>
              <input type="submit" style="display: none" />
            </form>
            <img class="graphics" src="/graphics/userPages/header/plus-icon.png" width="40" height="40"></img>
            <img class="graphics" src="/graphics/userPages/header/settings-icon.png" width="40" height="40"></img>
        </div> 
    </div> 
  </header>

  <div class = "page-content" id = "page-content">
    <div class = "inner-navbar">
        <div class = "left-inner-navbar">
            <h1 class = "headline-font standard-font"> visit branch</h1>
        </div>
        <div class = "right-inner-navbar">
            <h1 class = "headline-font standard-font"> branch</h1>
            <h1 class = "headline-font standard-font"> contribute</h1>
        </div>
    </div>
    <div class = "project-directory" id = "project-directory">
    </div>
    
  </div>

</body>

